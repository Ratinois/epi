<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventaire Epicerie</title>
    <style>
        :root { --accent: #e74c3c; --bg: #f4f4f4; --dark: #2c3e50; }
        body { font-family: sans-serif; margin: 0; background: var(--bg); display: flex; flex-direction: column; align-items: center; }
        
        .search-container { width: 100%; max-width: 500px; padding: 15px; background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 100; box-sizing: border-box; }
        .input-group { display: flex; gap: 8px; }
        input { flex: 1; padding: 12px 15px; border: 2px solid #eee; border-radius: 8px; font-size: 16px; outline: none; }
        .btn-x { padding: 10px 18px; background: #eee; border: none; cursor: pointer; font-weight: bold; border-radius: 8px; color: #333; font-size: 18px; }

        .suggestions { background: white; border: 1px solid #eee; position: absolute; width: calc(100% - 30px); max-width: 470px; display: none; margin-top: 5px; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .suggestion-item { padding: 14px; cursor: pointer; border-bottom: 1px solid #f9f9f9; }
        .suggestion-item:hover { background: #f8f9fa; color: var(--accent); }

        .plan-wrapper { position: relative; margin-top: 15px; width: 95%; max-width: 500px; background: white; border-radius: 8px; padding: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); box-sizing: border-box; }
        #plan-img { width: 100%; display: block; }
        #target-dot { position: absolute; width: 20px; height: 20px; background: var(--accent); border: 2px solid white; border-radius: 4px; display: none; transform: translate(-50%, -50%); box-shadow: 0 0 5px rgba(0,0,0,0.3); z-index: 10; }

        .result-card { background: white; width: 90%; max-width: 470px; margin: 20px; padding: 15px; border-radius: 12px; display: none; align-items: center; gap: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border-left: 5px solid var(--accent); }
        .sprite-viewer { 
            width: 100px; height: 100px; 
            border: 1px solid #eee; border-radius: 4px; 
            background-image: url('spritesheet.png'); 
            background-repeat: no-repeat; 
            background-size: 1000px 1500px; 
            flex-shrink: 0; 
        }

        .info h2 { margin: 0; font-size: 1.1em; color: var(--dark); }
        .info p { margin: 5px 0; font-size: 1.4em; color: var(--accent); font-weight: bold; }
        .shelf-tag { background: #f1f3f5; padding: 4px 8px; border-radius: 4px; font-size: 0.9em; color: #444; font-weight: 600; }
    </style>
</head>
<body>

<div class="search-container">
    <div class="input-group">
        <input type="text" id="searchInput" placeholder="Chercher un article..." autocomplete="off">
        <button class="btn-x" onclick="resetApp()">X</button>
    </div>
    <div id="suggestions" class="suggestions"></div>
</div>

<div class="plan-wrapper">
    <img src="plan.jpg" id="plan-img">
    <div id="target-dot"></div>
</div>

<div id="resultCard" class="result-card">
    <div id="sprite" class="sprite-viewer"></div>
    <div class="info">
        <h2 id="resName">Nom</h2>
        <p id="resPrice">0.00 &euro;</p>
        <span id="resShelf" class="shelf-tag">Etagere --</span>
    </div>
</div>

<script>
    const etageres = {
        "A1": [0.89, 0.1], "A2": [0.805, 0.1], "A3": [0.72, 0.1], "A4": [0.635, 0.1], "A5": [0.55, 0.1], "A6": [0.465, 0.1], "A7": [0.38, 0.1], "A8": [0.295, 0.1], "A9": [0.21, 0.1], "A10": [0.125, 0.18], "A11": [0.125, 0.25], "A12": [0.125, 0.325],
        "B1": [0.805, 0.325], "B2": [0.72, 0.325], "B3": [0.635, 0.325], "B4": [0.55, 0.325], "B5": [0.465, 0.325], "B6": [0.38, 0.325], "B7": [0.38, 0.395], "B8": [0.465, 0.395], "B9": [0.55, 0.395], "B10": [0.635, 0.395], "B11": [0.72, 0.395], "B12": [0.805, 0.395],
        "C1": [0.46, 0.59], "C2": [0.375, 0.59], "C3": [0.46, 0.67], "C4": [0.375, 0.67], "C5": [0.125, 0.59], "C6": [0.125, 0.67], "C7": [0.125, 0.75], "C8": [0.21, 0.86], "C9": [0.21, 0.93]
    };

    // Liste avec noms sécurisés pour les accents (Unicode)

    
    const produits = [
        {n:"Pois cassés bio",  e:"A1",     p:"1.5",    s:0},
        {n:"Dai / Yum",             e:"A1",     p:"1.25",   s:1},
        {n:"Huile",                 e:"A1",     p:"9",      s:2},
        {n:"Brioche burger",        e:"A1",     p:"0.5",    s:3},
        {n:"Tomacouli",             e:"A2",     p:"1.5",    s:4},
        {n:"Lentille",              e:"A2",     p:"1.5",    s:5},
        {n:"Haricot blanc",         e:"A2",     p:"1.5",    s:6},
        {n:"Purée de tomates",      e:"A2",     p:"0.8",    s:7},
        {n:"Couscous",              e:"A3",     p:"0.65",   s:8},
        {n:"Taboule",               e:"A3",     p:"0.25",   s:9},
        {n:"Couscous taboule",      e:"A3",     p:"0.8",    s:10},
        {n:"Petits pois",           e:"A3",     p:"1",      s:11},
        {n:"Cannelloni",            e:"A4",     p:"1.8",    s:12},
        {n:"Choucroute",            e:"A4",     p:"0.8",    s:13},
        {n:"Dounia",                e:"A4",     p:"1.5",    s:14},
        {n:"Pate demi complete",    e:"A5",     p:"0.75",   s:15},
        {n:"Jus citron",            e:"A5",     p:"0.3",    s:16},
        {n:"Thon",                  e:"A5",     p:"2",      s:17},
        {n:"Riz",                   e:"A6",     p:"1.65",   s:18},
        {n:"Semoule",               e:"A6",     p:"1",      s:19},
        {n:"Graine lin",            e:"A6",     p:"0.6",    s:20},
        {n:"Graine tournesol",      e:"A6",     p:"0.9",    s:21},
        {n:"Noix de coco",          e:"A7",     p:"0.9",    s:22},
        {n:"Poudre amande",         e:"A7",     p:"1.25",   s:23},
        {n:"Noisettes",             e:"A7",     p:"2.5",    s:24},
        {n:"Cerneaux",              e:"A7",     p:"0.9",    s:25},
        {n:"Raisins secs",          e:"A7",     p:"0.9",    s:26},
        {n:"Pruneaux",              e:"A7",     p:"1.5",    s:27},
        {n:"Tresor",                e:"A8",     p:"2.25/2.5",s:28},
        {n:"Cocopops",              e:"A8",     p:"1.5/1.75",s:29},
        {n:"Extra",                 e:"A8",     p:"2.25",   s:30},
        {n:"Specialk",              e:"A8",     p:"1",      s:31},
        {n:"Muesli",                e:"A9",     p:"1.5",    s:32},
        {n:"Roast",                 e:"A9",     p:"1.5",    s:33},
        {n:"Vegan",                 e:"A9",     p:"1.6",    s:34},
        {n:"Thé",                   e:"A9",     p:"1./1.5", s:35},
        {n:"Pampers",               e:"A10",    p:"4/5",    s:36},
        {n:"Pains choco/lait / tranchée",e:"A10",p:"1.25",  s:37},
        {n:"Nestum",                e:"A11",    p:"1.2",    s:38},
        {n:"Elgydium",              e:"A11",    p:"1",      s:39},
        {n:"Calisma",               e:"A11",    p:"3",      s:40},
        {n:"Bledina",               e:"A11",    p:"0.25",   s:41},
        {n:"Nanobebe",              e:"A11",    p:"0.5/2",  s:42},
        {n:"Elbebek",               e:"A12",    p:"5",      s:43},
        {n:"Yaourt maison",         e:"A12",    p:"1",      s:44},
        {n:"Mixabebe",              e:"A12",    p:"1.5",    s:45},
        {n:"Delichoc",              e:"B1",     p:"1/1.5",  s:46},
        {n:"Roses sables",          e:"B1",     p:"1.25",   s:47},
        {n:"Mini bn",               e:"B2",     p:"1",      s:48},
        {n:"Croquants",             e:"B2",     p:"2.5",    s:49},
        {n:"Brioche sliced",        e:"B2",     p:"2",      s:50},
        {n:"Caramel",               e:"B2",     p:"1.25",   s:51},
        {n:"Proteines",             e:"B2",     p:"1.5",    s:52},
        {n:"Crunchy",               e:"B3",     p:"1.25",   s:53},
        {n:"Schokobons",            e:"B3",     p:"0.5",    s:54},
        {n:"Duo",                   e:"B3",     p:"1.25",   s:55},
        {n:"Gerble",                e:"B3",     p:"0.4",    s:56},
        {n:"Nutella",               e:"B4",     p:"2.25",   s:57},
        {n:"Sauce",                 e:"B4",     p:"0.5",    s:58},
        {n:"Sucre",                 e:"B5",     p:"0.8",    s:59},
        {n:"Alsa",                  e:"B5",     p:"1",      s:60},
        {n:"Popcorn/Caramel",       e:"B6",     p:"1",      s:61},
        {n:"Croissant",             e:"B6",     p:"1.25",   s:62},
        {n:"Pancakes",              e:"B6",     p:"1",      s:63},
        {n:"Chocolat",              e:"B6",     p:"2",      s:64},
        {n:"Brioche doowap",        e:"B6",     p:"1.25",   s:65},
        {n:"Lessive",               e:"B7",     p:"3.5/5",  s:66},
        {n:"Wetjet",                e:"B7",     p:"2",      s:67},
        {n:"Liquide vaiselle",      e:"B8",     p:"0.5",    s:68},
        {n:"Eparcyl",               e:"B8",     p:"1.8",    s:69},
        {n:"Wcfrisch",              e:"B8",     p:"1.5",    s:70},
        {n:"Stmarc",                e:"B8",     p:"1.5",    s:71},
        {n:"Destop",                e:"B8",     p:"1.5",    s:72},
        {n:"You",                   e:"B8",     p:"1.5",    s:73},
        {n:"Pampilar",              e:"B9",     p:"2.5",    s:74},
        {n:"Savon noir",            e:"B9",     p:"2.5",    s:75},
        {n:"Demakup",               e:"B9",     p:"0.5",    s:76},
        {n:"Demakup expert",        e:"B9",     p:"1",      s:77},
        {n:"Ule",                   e:"B10",    p:"6",      s:78},
        {n:"Servietteh",            e:"B10",    p:"1",      s:79},
        {n:"Serviettesh Pedix",     e:"B10",    p:"1.5",    s:80},
        {n:"Always",                e:"B10",    p:"1.5",    s:81},
        {n:"Cicalfate",             e:"B11",    p:"3",      s:82},
        {n:"Regen",                 e:"B11",    p:"6",      s:83},
        {n:"Astera",                e:"B11",    p:"6",      s:84},
        {n:"Skil energy",           e:"B11",    p:"2",      s:85},
        {n:"Skil eau parfum",       e:"B11",    p:"3",      s:86},
        {n:"Tampax",                e:"B11",    p:"1",      s:87},
        {n:"Shampoing",             e:"B12",    p:"1.25",   s:88},
        {n:"Cleanance",             e:"B12",    p:"3",      s:89},
        {n:"Xeracalm",              e:"B12",    p:"5",      s:90},
        {n:"Shampoing familial",    e:"B12",    p:"0.9",    s:91},
        {n:"Shower gel",            e:"B12",    p:"2",      s:92},
        {n:"Retouche racine",       e:"B12",    p:"3",      s:93},
        {n:"Biofreeze",             e:"B12",    p:"2.5",    s:94},
        {n:"Reve de miel",          e:"B12",    p:"3.5",    s:95},
        {n:"Intima",                e:"B12",    p:"1",      s:96},
        {n:"Bioderme",              e:"B12",    p:"4",      s:97},
        {n:"Compeed",               e:"B12",    p:"2",      s:98},
        {n:"Moinho",                e:"C1",     p:"1",      s:99},
        {n:"Farine",                e:"C1",     p:"0.9",    s:100},
        {n:"Branches",              e:"C1",     p:"0.8",    s:101},
        {n:"Sel",                   e:"C1",     p:"0.8",    s:102},
        {n:"Sauce aigre",           e:"C1",     p:"1",      s:103},
        {n:"Moutarde",              e:"C1",     p:"0.5",    s:104},
        {n:"Prep four pain",        e:"C3",     p:"0.9",    s:105},
        {n:"Lait",                  e:"C4",     p:"0.9",    s:106},
        {n:"Sprite/pepsi",          e:"C5",     p:"1",      s:107},
        {n:"Orangina",              e:"C5",     p:"1",      s:108},
        {n:"Oasis",                 e:"C5",     p:"2",      s:109},
        {n:"Amandes",               e:"C6",     p:"1.5",    s:110},
        {n:"Petits beurres",        e:"C6",     p:"0.3",    s:111},
        {n:"Fruits rouge",          e:"C6",     p:"1.5",    s:112},
        {n:"Toasts",                e:"C6",     p:"0.5",    s:113},
        {n:"Pistaches",             e:"C7",     p:"1.5",    s:114},
        {n:"Snacks",                e:"C7",     p:"1",      s:115},
        {n:"Curly",                 e:"C7",     p:"1",      s:116},
        {n:"Chips",                 e:"C7",     p:"1",      s:117},
        {n:"Cacahuetes",            e:"C7",     p:"1",      s:118},
        {n:"Craquilles",            e:"C7",     p:"0.6",    s:119},
        {n:"Dixi",                  e:"C7",     p:"0.5",    s:120},
        {n:"Chips Lays",            e:"C7",     p:"0.6",    s:121},
        {n:"Mie/Pain de mie",       e:"C8",     p:"0.5",    s:122},
        {n:"Brioche sliders",       e:"C8",     p:"0.5",    s:123},
        {n:"Baguettes viennoises",  e:"C9",     p:"0.5",    s:124},
        
        // rajouts (hors-liste principale)
        {n:"Haribo",                e:"B5",     p:"1.5",    s:125},
        {n:"Calypso",               e:"C5",     p:"0.8",    s:126},
        {n:"Limonade",              e:"C5",     p:"0.5",    s:127},
        {n:"Ciboulette",            e:"C1",     p:"0.8",    s:128},
        {n:"Compote",               e:"B4",     p:"0.2",    s:129},
        {n:"Cheetos",               e:"C7",     p:"1",      s:130},
    ];

    const searchInput = document.getElementById('searchInput');
    const suggBox = document.getElementById('suggestions');

    searchInput.addEventListener('input', () => {
        const val = searchInput.value.toLowerCase().trim();
        suggBox.innerHTML = '';
        if (val.length < 1) { suggBox.style.display = 'none'; return; }

        const hits = produits.filter(p => p.n.toLowerCase().includes(val)).slice(0, 5);
        if (hits.length > 0) {
            hits.forEach(h => {
                const div = document.createElement('div');
                div.className = 'suggestion-item';
                div.innerText = h.n;
                div.onclick = () => selectArticle(h);
                suggBox.appendChild(div);
            });
            suggBox.style.display = 'block';
        } else {
            suggBox.style.display = 'none';
        }
    });

    function selectArticle(art) {
        searchInput.value = art.n;
        suggBox.style.display = 'none';
        
        document.getElementById('resultCard').style.display = 'flex';
        document.getElementById('resName').innerText = art.n;
        document.getElementById('resPrice').innerHTML = art.p + " &euro;";
        document.getElementById('resShelf').innerText = "Etagere " + art.e;

        const col = art.s % 10;
        const row = Math.floor(art.s / 10);
        document.getElementById('sprite').style.backgroundPosition = `-${col*100}px -${row*100}px`;

        const coords = etageres[art.e];
        if (coords) {
            const dot = document.getElementById('target-dot');
            dot.style.display = 'block';
            dot.style.left = (coords[0] * 100) + "%";
            dot.style.top = (coords[1] * 100) + "%";
        }
    }

    function resetApp() {
        searchInput.value = '';
        suggBox.style.display = 'none';
        document.getElementById('target-dot').style.display = 'none';
        document.getElementById('resultCard').style.display = 'none';
        searchInput.focus();
    }
</script>

</body>
</html>